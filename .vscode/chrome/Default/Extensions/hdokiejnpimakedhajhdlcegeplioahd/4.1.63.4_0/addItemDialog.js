var AddItemDialog=function(e){Dialog.call(this,e,{title:Strings.translateString("Add Item"),dynamicHeight:!1,closeButtonEnabled:!0,overlayDialog:!0,hideButtons:!0,additionalHeaderClasses:["icon"]})};AddItemDialog.prototype=Object.create(Dialog.prototype),AddItemDialog.prototype.constructor=AddItemDialog,AddItemDialog.prototype.addCard=function(e){var t=LPTools.createElement("div","col-3"),a=LPTools.createElement("button",e.classes?[].concat("addItemCard",e.classes):"addItemCard");return t.appendChild(a),e.icon&&a.appendChild(e.icon),a.appendChild(LPTools.createElement("span","addItemCardName",e.name)),e.parent.append(t),a},AddItemDialog.prototype.initialize=function(){Dialog.prototype.initialize.apply(this,arguments);var e=this,t=$("#addItemOptions"),a=$("#addItemCustomOptionsContainer").slideUp(),o=$("#addItemCustomOptions"),n=$("#addItemCustomOptionsLabel"),i={postSetup:function(){e.close()}};n.bind("click",function(){a.slideToggle(),n.toggleClass("open")});var s=bg.get("RecordTypeConfig");s.types.forEach(function(a){if(!a.composite&&(a.recordType===s.TYPE.Password||bg.Policies.showSecureNotes())){e.addCard({parent:t,name:a.name,classes:a.id}).addEventListener("click",function(){if(bg.lpevent("m_add"),LPFeatures.allowOmarDrawer())window.location.hash="/drawers/(drawer:new-item/"+a.id+")";else switch(a.recordType){case s.TYPE.Password:dialogs.site.open(i);break;default:dialogs.note.open($.extend(i,{defaultData:{notetype:a.recordType,language:Note.prototype.isValidLanguage(navigator.language)?navigator.language:"en-US"}}))}})}});var r=function(t){var a=e.addCard({parent:o,name:t.title,classes:"custom"}),n=LPTools.createElement("button","customTemplateDeleteButton");return n.appendChild(LPTools.createElement("i","fa fa-trash")),a.appendChild(n),a.addEventListener("click",function(){dialogs.note.open($.extend(i,{defaultData:{notetype:"Custom_"+t.id}}))}),n.addEventListener("click",function(e){e.stopPropagation(),dialogs.confirmation.open({title:Strings.translateString("Confirm Deletion"),text:[Strings.translateString("Are you sure you want to delete %1?",t.title),Strings.translateString("Any notes you created using this template will not be deleted.")],nextButtonText:Strings.translateString("Continue"),backButtonText:Strings.translateString(Strings.Vault.CANCEL),handler:function(){LPRequest.makeRequest(LPProxy.deleteCustomNoteTemplate,{params:{id:t.id},success:function(){var e=a.parentElement;e.parentElement.removeChild(e)},requestSuccessOptions:{closeDialog:!1}})}})}),a};if(bg.Policies.showSecureNotes()){LPProxy.getCustomNoteTemplates().forEach(r),Topics.get(Topics.SECURENOTE_TEMPLATE_ADDED).subscribe(function(e){var t=r(e);setTimeout(function(){t.focus()},0)});var d=this.addCard({parent:o.parent(),name:Strings.translateString("New custom item type"),icon:LPTools.createElement("i","fa fa-plus")});$(d).addClass("customTemplateAddButton").bind("click",function(){dialogs.customNoteTemplate.open()})}else n.remove()};